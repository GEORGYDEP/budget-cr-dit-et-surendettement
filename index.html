<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de budget - Gestion BudgÃ©taire</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="game-container">
        <!-- Ã‰cran d'accueil -->
        <div id="welcome-screen" class="screen active">
            <div class="welcome-content">
                <h1>ğŸ’° Simulateur de budget</h1>
                <p class="subtitle">Apprends Ã  gÃ©rer ton budget comme un pro !</p>
                <div class="game-info">
                    <p>ğŸ¯ Objectif : GÃ©rer tes finances pendant 12 mois sans tomber dans le surendettement</p>
                    <p>â±ï¸ DurÃ©e : 45-60 minutes</p>
                    <p>ğŸ† Gagne des badges en faisant les bons choix !</p>
                </div>
                <div class="difficulty-selection">
                    <h3>Choisis ton niveau :</h3>
                    <button class="btn-difficulty" data-level="facile">ğŸ˜Š Facile<br><small>Revenus confortables</small></button>
                    <button class="btn-difficulty" data-level="moyen">ğŸ˜ Moyen<br><small>Budget serrÃ©</small></button>
                    <button class="btn-difficulty" data-level="difficile">ğŸ˜° Difficile<br><small>Survie financiÃ¨re</small></button>
                </div>
            </div>
        </div>

        <!-- Ã‰cran de crÃ©ation du personnage -->
        <div id="character-screen" class="screen">
            <div class="character-content">
                <h2>ğŸ‘¤ CrÃ©e ton profil</h2>
                <div class="character-form">
                    <label>Adresse e-mail :</label>
                    <input type="email" id="player-name" placeholder="prenom.nom@istlm.org" pattern=".+@istlm\.org" required>
                    
                    <label>Ta situation :</label>
                    <select id="player-situation">
                        <option value="seul">Personne seule</option>
                        <option value="couple">Couple sans enfants</option>
                        <option value="famille">Famille avec 2 enfants</option>
                    </select>

                    <label>Ton emploi :</label>
                    <select id="player-job">
                        <option value="employe">EmployÃ©(e) de bureau</option>
                        <option value="ouvrier">Ouvrier(Ã¨re)</option>
                        <option value="vendeur">Vendeur(euse)</option>
                        <option value="technicien">Technicien(ne)</option>
                    </select>

                    <button id="start-game-btn" class="btn-primary">Commencer l'aventure ! ğŸš€</button>
                </div>
            </div>
        </div>

        <!-- Ã‰cran de jeu principal -->
        <div id="game-screen" class="screen">
            <!-- Header avec infos -->
            <div class="game-header">
                <div class="player-info">
                    <span class="player-name-display">ğŸ‘¤ <span id="display-name"></span></span>
                    <span class="month-display">ğŸ“… Mois <span id="current-month">1</span>/12</span>
                </div>
                <div class="budget-gauge">
                    <div class="gauge-label">ğŸ’° Solde</div>
                    <div class="gauge-value" id="current-balance">0 â‚¬</div>
                    <div class="gauge-bar">
                        <div class="gauge-fill" id="gauge-fill"></div>
                    </div>
                </div>
                <div class="score-display">
                    <span>ğŸ† Score : <span id="total-score">0</span></span>
                </div>
            </div>

            <!-- Zone de badges -->
            <div class="badges-bar">
                <div class="badge locked" id="badge-economie" title="Roi de l'Ã©pargne">ğŸ†</div>
                <div class="badge locked" id="badge-prudent" title="Acheteur prudent">ğŸ›¡ï¸</div>
                <div class="badge locked" id="badge-comparateur" title="Expert comparaison">ğŸ”</div>
                <div class="badge locked" id="badge-prevoyant" title="MaÃ®tre de la prÃ©voyance">ğŸ“Š</div>
                <div class="badge locked" id="badge-survivor" title="Survivant financier">ğŸ’ª</div>
            </div>

            <!-- Contenu principal du jeu -->
            <div class="game-content">
                <!-- Phase 1: Budget prÃ©visionnel -->
                <div id="phase-budget" class="phase-content">
                    <h2>ğŸ“‹ Mois 1 : Ã‰tablis ton budget prÃ©visionnel</h2>
                    <p class="phase-instruction">Classe chaque Ã©lÃ©ment dans la bonne catÃ©gorie (clique pour dÃ©placer)</p>
                    
                    <div class="budget-builder">
                        <div class="budget-section">
                            <h3>ğŸ’µ RECETTES (Revenus)</h3>
                            <div class="drop-zone" id="recettes-zone" data-type="recettes">
                                <p class="zone-hint">DÃ©pose ici les revenus</p>
                            </div>
                            <div class="total-display">Total : <span id="total-recettes">0</span> â‚¬</div>
                        </div>

                        <div class="budget-section">
                            <h3>ğŸ  DÃ‰PENSES FIXES</h3>
                            <div class="drop-zone" id="fixes-zone" data-type="fixes">
                                <p class="zone-hint">DÃ©pose ici les dÃ©penses obligatoires et stables</p>
                            </div>
                            <div class="total-display">Total : <span id="total-fixes">0</span> â‚¬</div>
                        </div>

                        <div class="budget-section">
                            <h3>ğŸ›’ DÃ‰PENSES VARIABLES</h3>
                            <div class="drop-zone" id="variables-zone" data-type="variables">
                                <p class="zone-hint">DÃ©pose ici les dÃ©penses modifiables</p>
                            </div>
                            <div class="total-display">Total : <span id="total-variables">0</span> â‚¬</div>
                        </div>
                    </div>

                    <div class="items-to-classify">
                        <h4>ğŸ¯ Ã‰lÃ©ments Ã  classer :</h4>
                        <div id="items-pool"></div>
                    </div>

                    <div class="phase-actions">
                        <button id="validate-budget-btn" class="btn-primary" disabled>Valider mon budget ğŸ“Š</button>
                    </div>
                </div>

                <!-- Phase 1b: Budget en dÃ©sÃ©quilibre -->
                <div id="phase-budget-imbalance" class="phase-content">
                    <div class="imbalance-alert">
                        <div class="imbalance-icon">âš ï¸</div>
                        <h2>Budget en dÃ©sÃ©quilibre</h2>
                        <p class="imbalance-message">
                            Votre budget est en dÃ©sÃ©quilibre.<br>
                            <strong>DÃ©ficit : <span id="deficit-amount">0</span> â‚¬</strong>
                        </p>
                        <p class="imbalance-explanation">
                            Vous avez deux possibilitÃ©s :
                        </p>
                        <div class="imbalance-choices">
                            <button id="reduce-expenses-btn" class="choice-btn choice-good">
                                <span class="choice-icon">âœ‚ï¸</span>
                                <span class="choice-text">
                                    <strong>RÃ©duire vos dÃ©penses</strong>
                                    <small>Ajustez vos dÃ©penses variables pour Ã©quilibrer votre budget</small>
                                </span>
                            </button>
                            <button id="take-credit-btn" class="choice-btn choice-bad">
                                <span class="choice-icon">ğŸ’³</span>
                                <span class="choice-text">
                                    <strong>Contracter un crÃ©dit</strong>
                                    <small id="credit-details">CoÃ»t total avec intÃ©rÃªts : 0 â‚¬</small>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Phase 1c: RÃ©duction des dÃ©penses -->
                <div id="phase-reduce-expenses" class="phase-content">
                    <h2>âœ‚ï¸ RÃ©duction des dÃ©penses variables</h2>
                    <p class="reduce-intro">
                        Ajustez vos dÃ©penses variables pour Ã©quilibrer votre budget.<br>
                        <strong>DÃ©ficit Ã  combler : <span id="deficit-to-cover">0</span> â‚¬</strong>
                    </p>

                    <div class="budget-recap">
                        <div class="recap-item">
                            <span>Revenus :</span>
                            <span class="amount-positive" id="reduce-revenus">0 â‚¬</span>
                        </div>
                        <div class="recap-item">
                            <span>DÃ©penses fixes :</span>
                            <span class="amount-negative" id="reduce-fixes">0 â‚¬</span>
                        </div>
                        <div class="recap-item">
                            <span>DÃ©penses variables :</span>
                            <span class="amount-negative" id="reduce-variables-total">0 â‚¬</span>
                        </div>
                        <div class="recap-item recap-solde">
                            <span>Solde :</span>
                            <span id="reduce-solde" class="amount-neutral">0 â‚¬</span>
                        </div>
                    </div>

                    <div class="expenses-adjustment">
                        <h3>Ajustez vos dÃ©penses variables :</h3>
                        <div id="variable-expenses-list">
                            <!-- Les dÃ©penses variables seront ajoutÃ©es dynamiquement -->
                        </div>
                    </div>

                    <div class="phase-actions">
                        <button id="revalidate-budget-btn" class="btn-primary">Revalider le budget ğŸ“Š</button>
                        <button id="cancel-reduction-btn" class="btn-secondary">Annuler</button>
                    </div>
                </div>

                <!-- Phase 2: Gestion mensuelle -->
                <div id="phase-monthly" class="phase-content">
                    <div class="monthly-summary">
                        <h2 id="monthly-title">ğŸ“… Mois 2 : Gestion du quotidien</h2>
                        <div class="budget-recap">
                            <div class="recap-item">
                                <span>Revenus prÃ©vus :</span>
                                <span class="amount-positive" id="recap-revenus">0 â‚¬</span>
                            </div>
                            <div class="recap-item">
                                <span>DÃ©penses fixes :</span>
                                <span class="amount-negative" id="recap-fixes">0 â‚¬</span>
                            </div>
                            <div class="recap-item">
                                <span>DÃ©penses variables :</span>
                                <span class="amount-negative" id="recap-variables">0 â‚¬</span>
                            </div>
                            <div class="recap-item">
                                <span>Reste disponible :</span>
                                <span class="amount-neutral" id="recap-reste">0 â‚¬</span>
                            </div>
                        </div>
                    </div>

                    <div class="event-card" id="event-card">
                        <div class="event-icon">âš¡</div>
                        <h3 id="event-title">Situation du mois</h3>
                        <p id="event-description"></p>
                        <div class="event-choices" id="event-choices">
                            <!-- Les choix seront ajoutÃ©s dynamiquement -->
                        </div>
                    </div>

                    <div class="monthly-stats">
                        <canvas id="expenses-chart"></canvas>
                    </div>
                </div>

                <!-- Phase 3: Ã‰vÃ©nement spÃ©cial / Crise -->
                <div id="phase-crisis" class="phase-content">
                    <div class="crisis-alert">
                        <div class="crisis-icon">âš ï¸</div>
                        <h2 id="crisis-title">Ã‰vÃ©nement majeur !</h2>
                        <p id="crisis-description"></p>
                        <div class="crisis-impact">
                            <h4>Impact sur ton budget :</h4>
                            <div id="crisis-impact-details"></div>
                        </div>
                        <div class="crisis-choices" id="crisis-choices">
                            <!-- Les choix seront ajoutÃ©s dynamiquement -->
                        </div>
                    </div>
                </div>

                <!-- Phase 4: Quiz Ã©ducatif -->
                <div id="phase-quiz" class="phase-content">
                    <h2>ğŸ§  Quiz : Teste tes connaissances</h2>
                    <div class="quiz-progress">
                        <span>Question <span id="quiz-current">1</span> / <span id="quiz-total">5</span></span>
                    </div>
                    <div class="quiz-card">
                        <h3 id="quiz-question"></h3>
                        <div class="quiz-options" id="quiz-options">
                            <!-- Options ajoutÃ©es dynamiquement -->
                        </div>
                        <div class="quiz-feedback" id="quiz-feedback"></div>
                    </div>
                </div>

                <!-- Phase 5: Bilan final -->
                <div id="phase-final" class="phase-content">
                    <div class="final-report">
                        <h2>ğŸŠ Fin de la simulation !</h2>
                        <div class="final-score-card">
                            <div class="final-score-big">
                                <span>Score final</span>
                                <div class="score-number" id="final-score-display">0</div>
                                <div class="score-rank" id="score-rank"></div>
                            </div>
                        </div>

                        <div class="final-stats">
                            <h3>ğŸ“Š Tes statistiques :</h3>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-icon">ğŸ’°</div>
                                    <div class="stat-label">Solde final</div>
                                    <div class="stat-value" id="stat-balance">0 â‚¬</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">ğŸ’³</div>
                                    <div class="stat-label">CrÃ©dits pris</div>
                                    <div class="stat-value" id="stat-credits">0</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">ğŸ’</div>
                                    <div class="stat-label">Ã‰pargne constituÃ©e</div>
                                    <div class="stat-value" id="stat-savings">0 â‚¬</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon">ğŸ¯</div>
                                    <div class="stat-label">Bonnes dÃ©cisions</div>
                                    <div class="stat-value" id="stat-good-choices">0</div>
                                </div>
                            </div>
                        </div>

                        <div class="badges-earned">
                            <h3>ğŸ† Badges obtenus :</h3>
                            <div id="badges-final-list"></div>
                        </div>

                        <div class="final-advice">
                            <h3>ğŸ’¡ Analyse de ta gestion :</h3>
                            <div id="final-feedback"></div>
                        </div>

                        <div class="knowledge-recap">
                            <h3>ğŸ“š Points clÃ©s Ã  retenir :</h3>
                            <div class="key-points">
                                <div class="key-point">
                                    <strong>Budget prÃ©visionnel :</strong> Planifier ses recettes et dÃ©penses pour Ã©viter les mauvaises surprises.
                                </div>
                                <div class="key-point">
                                    <strong>DÃ©penses fixes vs variables :</strong> Les fixes sont prioritaires, les variables peuvent Ãªtre ajustÃ©es.
                                </div>
                                <div class="key-point">
                                    <strong>Ã‰pargne de prÃ©caution :</strong> Essentielle pour faire face aux imprÃ©vus (panne, maladie...).
                                </div>
                                <div class="key-point">
                                    <strong>CrÃ©dit = danger :</strong> Ne jamais prendre un crÃ©dit pour en rembourser un autre.
                                </div>
                                <div class="key-point">
                                    <strong>Aide disponible :</strong> MÃ©diateur de dettes, CPAS, procÃ©dure judiciaire en cas de surendettement.
                                </div>
                            </div>
                        </div>

                        <div class="final-actions">
                            <button id="restart-btn" class="btn-primary">ğŸ”„ Rejouer</button>
                            <button id="print-btn" class="btn-secondary">ğŸ–¨ï¸ Imprimer mon rapport</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal pour les explications -->
        <div id="info-modal" class="modal">
            <div class="modal-content">
                <span class="modal-close">&times;</span>
                <h3 id="modal-title"></h3>
                <div id="modal-body"></div>
                <button class="btn-primary modal-ok">Compris !</button>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notification" class="notification"></div>
    </div>

    <script src="js/data.js"></script>
    <script src="js/profileRules.js"></script>
    <script src="js/game.js"></script>
</body>
</html>
